<!--Tam Tran-->
<!--Instructor: Mr. Lupoli-->
<!--Class: CMSC 331-->
<!--11/21/2014-->
<!--Project 1-->
<!--description: This is the head.html, this is a standardize page with cascading style sheet, layout, and scripts-->
<!--predefined for all pages in this directory-->
<!DOCTYPE html>

<html>
	<head>
		<meta charset="ISO-8859-1">
		<title>Planes For Hire</title>
		
		<?php	
			include ('link.php');
			$link = new Link($debug);
			$mapTbl = $link->executeQuery("select * from `airport_locations`", $_SERVER["SCRIPT_NAME"]);
		?>
		
		<style>
			/* removes underline from links */
			a {text-decoration:none}
			
			body
			{	
    			background-color: linen;
				font-family: Arial, Verdana;
				margin-top: 30px;
				margin-left: auto;
     			margin-right: auto;
				width: 1000px;
			}
			
			pre
			{
				font-family: Arial, Verdana;
			}
			
			#loginPage
			{
				background-color: #d1d1d1;
				font-family: Arial, Verdana;
				font-size: 16px;
				margin-top: 70px;
     			padding: 0px 30px;
				margin-left: auto;
     			margin-right: auto;
     			border-radius: 30px;
				width: 309px;
			}
			
			h2
			{
				background-color:#A5A5A5;
				text-align:center;
				font-size: 35px;
				color: #595959;
				border-radius: 30px 30px 0 0;
				width: 357px;
				margin: 10px -30px;
				padding: 6px
			}
			
			#registration
			{
				background-color: #d1d1d1;
				font-family: Arial, Verdana;
				font-size: 16px;
				padding: 0px 30px;
				margin-left: auto;
     			margin-right: auto;
     			border-radius: 30px;
				width: 500px;
			}
			
			h3
			{
				background-color:#A5A5A5;
				text-align:center;
				font-size: 35px;
				color: #595959;
				border-radius: 30px 30px 0 0;
				width: 548px;
				margin: 10px -30px;
				padding: 6px
			}
			
			#textBox
			{
				font-family: Arial, Helvetica, sans-serif;
				font-size: 14px;
				width: 150px;
				height: 17px;
				float:right;
				vertical-align: top;
				border: 0px solid #0076a3; 
				border-right: solid 0px;
				border-top-left-radius: 3px 3px;
				border-bottom-left-radius: 3px 3px;
			}
			#searchButton
			{
				font-family: Arial, Helvetica, sans-serif;
				font-size: 13px;
				width: 50px;
				height: 19px;
				float: right;
				outline: none;
				cursor: pointer;
				text-align: center;
				text-decoration: none;
				color: #ffffff;
				vertical-align: top;
				border: solid 0px #0076a3;
				border-right: 0px;
				background: #008AB8;
				background: -webkit-gradient(linear, left top, left bottom, from(#00adee), to(#0078a5));
				background: -moz-linear-gradient(top,  #00adee,  #0078a5);
				border-top-right-radius: 3px 3px;
				border-bottom-right-radius: 3px 3px;
			}
			#searchButton:hover
			{
				text-decoration: none;
				background: #33A1C6;
				background: -webkit-gradient(linear, left top, left bottom, from(#0095cc), to(#00678e));
				background: -moz-linear-gradient(top,  #0095cc,  #00678e);
			}
			/* Fixes submit button height problem in Firefox */
			#searchButton::-moz-focus-inner
			{
				border: 0;
			}		
			
			#checkInButton
			{	
				background-color: #FF6666;
				color: white;
				border-radius: 9px;
				height: 30px;
				width: 140px; 
				border: none;
				outline: none;
				float: center;
				font-family: Arial, Verdana;
				font-size: 15px;
			}
			#checkInButton:hover
			{	
				background-color: #FF9191;
				color: white;
			}
			#checkOutButton
			{	
				background-color: #00CC66;
				color: white;
				border-radius: 9px;
				height: 30px;
				width: 140px; 
				border: none;
				outline: none;
				float: center;
				font-family: Arial, Verdana;
				font-size: 15px;
			}
			#checkOutButton:hover
			{	
				background-color: #4DDB94;
				color: white;
			}

			#submitButton
			{	
				background-color: #008AB8;
				color: white;
				border-radius: 9px;
				height: 30px;
				width: 140px; 
				border: none; //0px #a1a1a1 solid;
				outline: none;
				font-family: Arial, Verdana;
				font-size: 16px;
				margin-left:auto;
				margin-right:auto;
				display:block;
			}
			#submitButton:hover
			{	
				background-color: #33A1C6;
				color: white;
			}
			#datePicker
			{
				font-family: Arial, Helvetica, sans-serif;
				font-size: 12px;
				width: 63px;
				height: 14px;
				border: 0px solid #0076a3; 
				border-right: solid 0px;
				border-radius: 3px;
			}
			select
			{	
				font-family: Arial, Helvetica, sans-serif;
				border: 0px #a1a1a1 solid;
				font-size: 12px;
				border-radius: 3px;
				width: 60px;
				height: 16px;
				padding: 1px;
				-webkit-appearance:none;
				-moz-appearance: none;
				appearance: none;
				font-family: Arial, Verdana;

			}
			select::-ms-expand
			{	
				display: none;
			}
			.input
			{	
				background-color: #ffffff;
				border: 0px #a1a1a1 solid;
				border-radius: 4px;
				padding: 2px;
				float:right;
				height: 20px;
				width: 305px;
				font-size: 15px;
			}
			
			.basePanel
			{        
			    width:90%;	    
			}
			.leftPanel
			{        
			    //background-color:#b2b2b2;
			    width:33.33%;
			    float:left;
			    text-align: left;
			}
			.middlePanel
			{        
			    //background-color:#8e8e8e;
			    width:33.33%;
			    float:left;
			    text-align: left;
			}
			.rightPanel
			{        
			    //background-color:#b2b2b2;
			    width:33.33%;
			    float:left;
			    text-align: left;
			}
			
			span
			{
				color: red;
			}
			
			#googleMap
			{
				width: 1000px;
				height: 500px;
				border-radius: 10px;
			}
		</style>
		
		<script src="http://maps.googleapis.com/maps/api/js"></script>
		
		<script>
			// --------------- Init function for map -------------------------------
			var map; //need this variable as global to use in multiple functions
			
			function initialize()
			{
				// -------------------- Constructs and initializes sexy-assed map -------------------------
				var mapProp =
				{
					center:new google.maps.LatLng(38.954413, -96.271539),
					zoom:4,
					mapTypeId:google.maps.MapTypeId.ROADMAP
				};
				map = new google.maps.Map(document.getElementById("googleMap"), mapProp);

				// -------------------------- Creates markers, and adds them to a list--------------------------------
				/*
				var markers = [];
				
				markers.push(createMarker(45, -120, "porty-air-lol", map));
				markers.push(createMarker(35, -101, "high-as-a-kite", map));
				
				//Pans to it
				map.panTo(markers[0].getPosition());
				*/
				
				<?php
					if (isset($mapTbl))						
						while ($row = mysql_fetch_array($mapTbl))
							print("createMarker(\"".$row ['airport']."\", ".$row ['long'].", ".$row ['lat'].");");
				?>
				
			}
			
			function focusMarker(long, lat, id, value)
			{
				map.panTo(new google.maps.Marker({position: new google.maps.LatLng(long, lat, 0)}).getPosition());
				updateForm(id, value);
			}
			
			function updateForm (id, value)
			{
				document.getElementById(id).innerHTML = value;
				
				if (document.getElementById('durationLabel').innerHTML !== '' && document.getElementById('startLabel').innerHTML !== '')
				{
					var msec = Date.parse(document.getElementById('startLabel').innerHTML);
					var date = new Date(msec);
					date.setDate(date.getDate() + parseInt(document.getElementById('durationLabel').innerHTML));
					var formDate = (date.getMonth() + 1) + "/" + date.getDate() + "/" + date.getFullYear(); 
					document.getElementById('returnLabel').innerHTML = formDate;
				}
			}
			
			// Creates easy to use icon
			function createMarker(name, long, lat)
			{
				var img = "resources/images/tack.gif";
				var marker = new google.maps.Marker
				({
      				position: new google.maps.LatLng(long, lat, 0),
     				map: map,
     			 	title: name,
					icon: img
  				});
				return marker;
			}
			
			google.maps.event.addDomListener(window, 'load', initialize);
			
			//this function performs a check to verify if all required fields are entered before submitting
			function confirmEntry ()
			{
				if (document.getElementById ('firstName').value != '')
					if (document.getElementById ('lastName').value != '')
						if ((document.getElementById ('street').value) != '')
							if (document.getElementById ('city').value != '')
								if (document.getElementById ('state').value != '')
									if (document.getElementById ('zip').value != '')
										if (document.getElementById ('phone').value != '')
											if (document.getElementById ('email').value != '')
												if (document.getElementById ('password').value != '')
													if (document.getElementById ('password2').value == document.getElementById ('password').value)
														document.form.submit();
													else
														alert ('the password doesn\'t match');
												else
													alert ('you need to enter your a password');
											else
												alert ('you need to enter your email');
										else
											alert ('you need to enter your phone number');
									else
										alert ('you need to enter your zip code');
								else
									alert ('you need to enter your state');
							else
								alert ('you need to enter your city');
						else
							alert ('you need to enter your street address');
					else
						alert ('You need to enter your last name'); 
				else
					alert ('You need to enter your first name');				
			}
		</script>
		
		<!--this java script function verifies the phone number entered are only digits, if the user enters a non digits character it will be remove-->
		<script type='text/javascript'> 
			function isValidChar (char, id)
			{
			        var txt = char;
				var found = false;
				var validChars = "0123456789"; //List of valid characters

				for(j = 0; j < txt.length; j++) //Will look through the value of text
				{
					var c = txt.charAt (j);
					found = false;
					for (x = 0; x < validChars.length; x++)
					{
						if (c == validChars.charAt (x))
						{
							found = true;
							break;
						}
					}
					if (!found)
					{
						if (id == 'zip')
							document.getElementById('zip').value = char.substring(0, char.length -1);
						if (id == 'phone')
							document.getElementById('phone').value = char.substring(0, char.length -1);
						break;
					}
				}
			}
			
			function checkOut(checkOutStatus)
			{				
				var depart = document.getElementById('departLabel').innerHTML;
				var arrive = document.getElementById('arrivalLabel').innerHTML;
				var duration = document.getElementById('durationLabel').innerHTML;
				var startDate = document.getElementById('startLabel').innerHTML;
				var returnDate = document.getElementById('returnLabel').innerHTML;
				var model = document.getElementById('planeLabel').innerHTML;
				
				if (parseInt(checkOutStatus) === 0)
				{
					if (depart !== '' && arrive !== '' && duration !== '' && startDate !== '' && returnDate !== '' && model !== '')
					{
						var data = "depart="+depart+"&arrive="+arrive+"&duration="+duration+"&startDate="+startDate+"&returnDate="+returnDate+"&model="+model;
						var confirmMsg = "Check Out Confirmation\nChecking out " + model + " on " + startDate + " for " + duration + " days.\nDeparting from " + depart + " to " + arrive + "\nCheck in by " + returnDate + ". Proceed with Rental?"; 
						
						if (!confirm(confirmMsg)) //don't remove this statement!!! for some reason the check out process works efficiently with it. there appear to be some latency issue 
							return; //involve while the variables are populating, and without this statement, many of them didn't populate fast enough and nothing gets push into the database
							
						if (window.XMLHttpRequest)
							xmlhttp = new XMLHttpRequest();
						else
							xmlhttp = new ActiveXObject ("Microsoft.XMLHTTP");
						
						xmlhttp.onreadystatechange = function()
						{
							if (xmlhttp.readyState == 4 && xmlhttp.status == 200)
								;
						}
					
						xmlhttp.open ("post", "checkOut.php", "true");
						xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
						xmlhttp.send (data);
						window.location.replace("index.html");
					} else
					{
						alert("Plane Rental Form Incomplete");
						return;
					}
				} else
				{
					alert("Something's wrong. Did you already Checkout a Plane?");
					return;
				}
			}
			
			function checkIn(checkOutStatus)
			{
				if (parseInt(checkOutStatus) === 1)
				{
				//	if (!confirm("are you sure?"))
				//		return;
						
					if (window.XMLHttpRequest)
						xmlhttp = new XMLHttpRequest();
					else
						xmlhttp = new ActiveXObject ("Microsoft.XMLHTTP");
						
					xmlhttp.onreadystatechange = function()
					{
						if (xmlhttp.readyState == 4 && xmlhttp.status == 200)
							;
					}
					
					xmlhttp.open ("post", "checkIn.php", "true");
					xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
					xmlhttp.send (null);
					window.location.replace("index.html");
				} else
					alert ("You don't have any planes checked out");
				return;
			}
			
		</script>
		
		<link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
  		<script src="//code.jquery.com/jquery-1.10.2.js"></script>
  		<script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
  		<link rel="stylesheet" href="/resources/demos/style.css">
  		<script>
  			$(function()
  			{
    			$("#datePicker").datepicker();
  			});
  		</script>
	</head>
	<body>
		<div>
		<font size = "4">
		<pre>